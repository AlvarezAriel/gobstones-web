<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../scripts/jquery.html">

<dom-module id="gobstones-ide">
  <template>

    <div class="panel-container">
      <div class="panel-left">
        <editor-toolbar project-type="[[projectType]]" id="toolbar"></editor-toolbar>

        <template is="dom-if" if="{{isBlocksProject(projectType)}}">
          <gobstones-blockly id="editor"></gobstones-blockly>
        </template>

        <template is="dom-if" if="{{isCodeProject(projectType)}}">
          <gobstones-editor id="editor"></gobstones-editor>
        </template>
      </div>

      <div class="panel-right">
        <boards-panel id="boards"></boards-panel>
      </div>
    </div>

  </template>

  <script>

    Polymer({
      is: 'gobstones-ide',
      listeners: {
        "show-code-changed": "_showCodeChanged",
        "show-boards-changed": "_showBoardsChanged"
      },
      properties: {
        projectType: String
      },

      isBlocksProject: function(projectType) { return projectType === 'blocks'; },
      isCodeProject: function(projectType) { return projectType === 'code'; },

      buttonCssClass: function(show) {
        return !show ? "button-disabled" : "";
      },

      _showCodeChanged: function({ detail }) {
        this._resizeLeftPanel(detail, 0);
      },

      _showBoardsChanged: function({ detail }) {
        this._resizeLeftPanel(detail, $(document).width());
      },

      _resizeLeftPanel: function(show, size) {
        $(".panel-left").width(
          show ? $(document).width() * 0.6 : size
        );
        $(window).trigger("resize");
      }
    });

  </script>
</dom-module>
