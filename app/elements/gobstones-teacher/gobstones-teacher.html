<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../scripts/parser.html">
<link rel="import" href="../../scripts/behaviors/busListenerBehavior.html">
<link rel="import" href="../../scripts/jquery.html">
<link rel="import" href="../../scripts/simplemde.html">

<dom-module id="gobstones-teacher">
  <template>

    <style>
      paper-tab {
        --paper-tab-content-unselected: {
          opacity: 0.5;
        }
      }

      .editor {
        position: absolute;
        width: 100%;
        height: 100%;
        left: 0;
        top: 0;
      }

      .visible {
        visibility: visible;
      }

      .unvisible {
        visibility: hidden;
      }
    </style>

    <div>
      <paper-tabs id="editorTab" selected="{{selectedTab}}" class="bottom self-end">
        <paper-tab>[[localize("code")]]</paper-tab>
        <paper-tab>[[localize("blocks")]]</paper-tab>
        <paper-tab>[[localize("students-library")]]</paper-tab>
        <paper-tab>[[localize("teachers-library")]]</paper-tab>
        <paper-tab>[[localize("description")]]</paper-tab>
        <paper-tab>[[localize("settings")]]</paper-tab>
      </paper-tabs>

      <div style="position: relative">
        <gobstones-editor id="code-editor" class$="editor {{_codeClass(selectedTab)}}"></gobstones-editor>

        <gobstones-blockly id="blocks-editor" class$="editor {{_blocksClass(selectedTab)}}"></gobstones-blockly>

        <gobstones-editor id="library-editor" class$="editor {{_libraryClass(selectedTab)}}"></gobstones-editor>

        <gobstones-editor id="teacher-library-editor" class$="editor {{_teacherLibraryClass(selectedTab)}}"></gobstones-editor>

        <description-editor id="description-editor" class$="editor {{_descriptionClass(selectedTab)}}"></description-editor>

        <div class$="editor {{_metadataClass(selectedTab)}}">Metadata</div>
      </div>
    </div>

  </template>

  <script>

    Polymer({
      is: "gobstones-teacher",
      behaviors: [
        Polymer.BusListenerBehavior,
        Polymer.LocalizationBehavior
      ],
      properties: {
        selectedTab: {
          type: Number,
          value: 0
        }
      },
      listeners: {
      },

      ready: function() {
      },

      addCode: function(xml) {
        // TODO: Pasar mÃ©todos a los correspondientes hijitos
        this.$.blockly.appendBlocksToWorkspace(xml);
      },

      setCode: function(code, mode = "main") {
      },

      reset: function() {
      },

      _codeClass: (selectedTab) => selectedTab === 0 ? "visible" : "unvisible",
      _blocksClass: (selectedTab) => selectedTab === 1 ? "visible" : "unvisible",
      _libraryClass: (selectedTab) => selectedTab === 2 ? "visible" : "unvisible",
      _teacherLibraryClass: (selectedTab) => selectedTab === 3 ? "visible" : "unvisible",
      _descriptionClass: (selectedTab) => selectedTab === 4 ? "visible" : "unvisible",
      _metadataClass: (selectedTab) => selectedTab === 5 ? "visible" : "unvisible"
    });

  </script>
</dom-module>
